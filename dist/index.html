<!DOCTYPE html>
<html lang="he" dir="rtl" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>住驻专 转 砖</title>
  <meta name="description" content="住驻专 转  - 砖专,  驻砖 转 转 砖">
  
  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#a7f3d0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="转">
  
  <!-- Favicon and Icons -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'></text></svg>">
  <link rel="apple-touch-icon" href="/icons/icon-152x152.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png">
  <link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png">
  <link rel="apple-touch-icon" sizes="128x128" href="/icons/icon-128x128.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png">
  <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png">
  <link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png">
  <link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png">
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#a7f3d0", // Pale Mint
            "primary-hover": "#6ee7b7",
            "secondary": "#fda4af", // Soft Peach/Pink
            "accent": "#c4b5fd", // Lavender
            "background-light": "#fdfbf7", // Warm off-white
            "background-dark": "#0f172a", 
            "card-dark": "#1e293b",
            "card-light": "#ffffff",
          },
          fontFamily: {
            display: ["Outfit", "sans-serif"],
          },
          boxShadow: {
            'glow': '0 0 25px -5px rgba(167, 243, 208, 0.6)', 
            'glow-teal': '0 0 20px -5px rgba(45, 212, 191, 0.5)',
            'glow-hover': '0 0 35px -5px rgba(167, 243, 208, 0.8)',
            'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.07)',
            'soft': '0 10px 40px -10px rgba(0,0,0,0.08)',
            'glow-ai': '0 0 25px -5px rgba(196, 181, 253, 0.8)',
          },
          animation: {
            'float': 'float 6s ease-in-out infinite',
            'blob': 'blob 10s infinite',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            },
            blob: {
              "0%": { transform: "translate(0px, 0px) scale(1)" },
              "33%": { transform: "translate(30px, -50px) scale(1.1)" },
              "66%": { transform: "translate(-20px, 20px) scale(0.9)" },
              "100%": { transform: "translate(0px, 0px) scale(1)" }
            }
          }
        },
      },
    };
  </script>
  
  <!-- Custom Styles -->
  
  <script>
    // Dark mode toggle
    function toggleDarkMode() {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
    }
    
    // Load dark mode preference
    if (localStorage.getItem('darkMode') === 'true') {
      document.documentElement.classList.add('dark');
    }
  </script>
  <script type="module" crossorigin src="/assets/index-BQ1cFjJo.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/index-BKKqk7eo.css">
<link rel="manifest" href="/manifest.webmanifest"><script id="vite-plugin-pwa:register-sw" src="/registerSW.js"></script></head>
<body class="bg-background-light dark:bg-background-dark text-slate-800 dark:text-slate-100 font-display transition-colors duration-500 min-h-screen relative selection:bg-primary selection:text-slate-900">
  <!-- Animated Blobs -->
  <div class="blob-1"></div>
  <div class="blob-2"></div>
  <div class="blob-3"></div>
  
  <header class="header glass-panel">
    <h1>
      <div class="header-logo-icon">
        <span class="material-symbols-outlined">restaurant_menu</span>
      </div>
      住驻专 <span class="header-logo-gradient">转</span>
    </h1>
    <!-- Search Bar in Header -->
    <div class="header-search-container">
      <div class="header-search-wrapper">
        <span class="material-symbols-outlined header-search-icon">search</span>
        <input type="text" id="searchName" class="header-search-input" placeholder="驻砖 转..." oninput="filterRecipes()">
        <span class="material-symbols-outlined header-filter-icon" onclick="toggleFilterPanel()" title="驻转/住专 住">tune</span>
      </div>
    </div>
    <div class="header-controls">
      <button onclick="toggleDarkMode()" class="header-btn" title="爪 /专">
        <span class="material-symbols-outlined dark:hidden">dark_mode</span>
        <span class="material-symbols-outlined hidden dark:block" style="color: var(--primary-color);">light_mode</span>
      </button>
      <!-- Timer Widget - Collapsible -->
      <div class="timer-widget" id="timer-widget">
        <button id="timer-toggle-btn" class="timer-toggle-btn" title="专">
          <span class="material-symbols-outlined timer-icon">timer</span>
          <span class="timer-mini-display" id="timer-mini-display"></span>
        </button>
        <div class="timer-expanded" id="timer-expanded">
          <div class="timer-expanded-header">
            <span class="timer-title">专 砖</span>
            <button id="timer-close-btn" class="timer-close-btn" title="住专">
              <span class="material-symbols-outlined">close</span>
            </button>
          </div>
          <div class="timer-content">
            <div class="timer-display-large" id="timer-display"></div>
            <div class="timer-input-group">
              <div class="timer-input-wrapper">
                <input type="number" id="timer-hours" min="0" max="99" step="1" value="0" class="timer-input" placeholder="0">
                <span class="timer-input-label">砖注转</span>
              </div>
              <span class="timer-separator">:</span>
              <div class="timer-input-wrapper">
                <input type="number" id="timer-minutes" min="0" max="59" step="1" value="1" class="timer-input" placeholder="0">
                <span class="timer-input-label">拽转</span>
              </div>
              <span class="timer-separator">:</span>
              <div class="timer-input-wrapper">
                <input type="number" id="timer-seconds" min="0" max="59" step="1" value="0" class="timer-input" placeholder="0">
                <span class="timer-input-label">砖转</span>
              </div>
            </div>
            <div class="timer-controls">
              <button id="start-timer" class="timer-action-btn timer-start" title="转">
                <span class="material-symbols-outlined">play_arrow</span>
                <span>转</span>
              </button>
              <button id="pause-timer" class="timer-action-btn timer-pause" title="砖" style="display: none;">
                <span class="material-symbols-outlined">pause</span>
                <span>砖</span>
              </button>
              <button id="stop-timer" class="timer-action-btn timer-stop" title="注爪专" style="display: none;">
                <span class="material-symbols-outlined">stop</span>
                <span>注爪专</span>
              </button>
            </div>
            <div class="timer-presets">
              <span class="timer-presets-label"> 专:</span>
              <div class="timer-presets-grid">
                <button class="preset-btn" data-time="300">5 拽壮</button>
                <button class="preset-btn" data-time="600">10 拽壮</button>
                <button class="preset-btn" data-time="900">15 拽壮</button>
                <button class="preset-btn" data-time="1800">30 拽壮</button>
                <button class="preset-btn" data-time="2700">45 拽壮</button>
                <button class="preset-btn" data-time="3600">砖注</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Hidden file input for JSON import -->
  <input type="file" id="importJson" accept=".json" style="display: none;" onchange="importRecipes(event)">

  <main class="main">
    <!-- Filter Panel -->
    <div class="main-filter-panel" id="searchContainer" style="display: none;">
      <div class="search-filters-row">
        <div class="search-filter-item">
          <span class="material-symbols-outlined search-filter-icon">shopping_basket</span>
          <input type="text" id="searchIngredients" class="search-filter-input" placeholder="驻砖 驻 爪专" oninput="filterRecipes()">
        </div>
        <div class="search-filter-item">
          <span class="material-symbols-outlined search-filter-icon">schedule</span>
          <input type="number" id="searchPrepTime" class="search-filter-input" placeholder="  (拽转)" min="0" oninput="filterRecipes()">
        </div>
        <div class="search-filter-item">
          <span class="material-symbols-outlined search-filter-icon">star</span>
          <div class="filter-rating" id="filterRating"></div>
        </div>
      </div>
    </div>
    <!-- Category Filter Buttons Row -->
    <div class="category-filter-row">
      <div class="category-filter" id="categoryFilter">
        <!-- 驻转专 拽专转 转住驻 转 -->
      </div>
    </div>
    
    <!-- Grid Selector (Fixed Position) -->
    <div class="grid-selector-wrapper">
      <button id="grid-selector-btn" class="grid-selector-btn" title="转 砖专" onclick="toggleGridSelector()">
        <span class="material-symbols-outlined">grid_view</span>
      </button>
      <div id="grid-selector-menu" class="grid-selector-menu" style="display: none;">
        <button class="grid-option" data-cols="4">4 砖专</button>
        <button class="grid-option" data-cols="5">5 砖专</button>
        <button class="grid-option" data-cols="6">6 砖专</button>
        <button class="grid-option" data-cols="7">7 砖专</button>
      </div>
    </div>
    
    
    <div class="recipes-container" id="recipesContainer"></div>
  </main>

  <!--  转 -->
  <div class="popup-overlay" id="popup">
    <div class="popup-content">
      <button class="close-btn" onclick="closePopup()">&times;</button>
      <div id="popupBody"></div>
    </div>
  </div>

  <!--  住驻转 转 -->
  <div class="popup-overlay" id="formPopup" style="display: none;">
    <div class="form-popup-content form-popup-redesign pastel-mesh">
      <!-- Decorative blobs -->
      <div class="form-blob form-blob-1"></div>
      <div class="form-blob form-blob-2"></div>
      
      <button class="close-btn" onclick="closeFormPopup()">&times;</button>
      
      <form id="recipeForm" class="form-two-columns">
        <!-- 注 砖转 - 转 驻专 -->
        <div class="form-column form-column-left">
          <div class="form-card glass-card">
            <!-- 驻住 爪注 注 -->
            <div class="form-card-accent"></div>
            
            <div class="form-card-content">
              <!-- 爪专 -->
              <div class="form-section">
                <h3 class="form-section-header">
                  <span class="material-symbols-outlined form-section-icon text-green-600">grocery</span>
                  爪专 -  驻砖转
                  <span class="form-section-badge">专砖</span>
                </h3>
                <div class="form-input-wrapper">
                  <textarea id="ingredients" class="glass-input" placeholder="专砖  转  爪专,  爪专 砖专 砖...
砖:
2 住转 拽
1 驻转 拽转 驻
3 爪 L" rows="6"></textarea>
                  <div class="form-input-action">
                    <button type="button" class="ai-format-btn" title="拽  转 专砖  注爪 转">
                      <span class="material-symbols-outlined">auto_awesome</span>
                    </button>
                  </div>
                </div>
              </div>

              <!-- 专转  -->
              <div class="form-section">
                <h3 class="form-section-header">
                  <span class="material-symbols-outlined form-section-icon text-orange-400">menu_book</span>
                  专转 
                </h3>
                <textarea id="instructions" class="glass-input" placeholder="转专  转 砖  驻专..." rows="8"></textarea>
              </div>

              <!-- 注专转 -->
              <div class="form-section">
                <h3 class="form-section-header">
                  <span class="material-symbols-outlined form-section-icon text-yellow-500">lightbulb</span>
                  注专转
                </h3>
                <textarea id="notes" class="glass-input" placeholder="驻 拽 砖专 ..." rows="3"></textarea>
              </div>

              <!-- 拽砖专 -->
              <div class="form-section form-section-links">
                <div class="form-field">
                  <label class="form-label" for="recipeLink">拽砖专 转</label>
                  <input type="url" id="recipeLink" name="recipeLink" class="glass-input" placeholder="https://">
                </div>
                <div class="form-field">
                  <label class="form-label" for="recipeVideo">拽砖专 </label>
                  <div class="form-input-with-icon">
                    <span class="material-symbols-outlined input-icon text-red-500">play_circle</span>
                    <input type="url" id="recipeVideo" name="recipeVideo" class="glass-input has-icon" placeholder="拽  拽砖专 (驻爪)">
                  </div>
                </div>
              </div>
            </div>

            <!-- 驻转专 砖专 爪祝 -->
            <div class="form-save-area">
              <button type="submit" class="form-save-btn">
                <span class="material-symbols-outlined">save</span>
                砖专 转
              </button>
            </div>
          </div>
        </div>

        <!-- 注 转 - 注 住住 -->
        <div class="form-column form-column-right">
          <!-- 转专转 -->
          <header class="form-header">
            <h2 class="form-title">转 砖</h2>
            <p class="form-subtitle">砖转驻 转 注 爪专 拽专转 砖</p>
          </header>

          <!-- 注转 转 -->
          <div class="image-upload-area" onclick="document.getElementById('image').click()">
            <div class="image-upload-content">
              <div class="image-upload-icon">
                <span class="material-symbols-outlined">add_a_photo</span>
              </div>
              <h3 class="image-upload-title">注转 转</h3>
              <p class="image-upload-hint">PNG, JPG 注 10MB</p>
            </div>
            <div class="image-upload-sparkle">
              <span class="material-symbols-outlined">auto_awesome</span>
            </div>
            <div id="imagePreviewContainer" class="image-preview-container" style="display: none;">
              <img id="imagePreview" src="" alt="转爪 拽">
            </div>
          </div>
          <input type="file" id="image" accept="image/*" style="display: none;" onchange="previewFormImage(event)">
          
          <!-- OCR Button -->
          <div class="ocr-upload-area">
            <button type="button" class="ocr-btn" onclick="document.getElementById('ocrImage').click()">
              <span class="material-symbols-outlined">document_scanner</span>
               拽住 转 (OCR)
            </button>
            <input type="file" id="ocrImage" accept="image/*" onchange="processOCR(event)" style="display: none;">
          </div>

          <!-- 砖转 注 住住 -->
          <div class="form-basic-fields">
            <!-- 砖 转 -->
            <div class="form-field">
              <label class="form-label" for="recipeName">砖 转</label>
              <input type="text" id="recipeName" class="glass-input form-input-underline" placeholder="砖: 驻住 专 砖转">
            </div>

            <!-- 拽专 转 -->
            <div class="form-field">
              <label class="form-label" for="recipeSource">拽专 转</label>
              <div class="form-input-with-icon">
                <span class="material-symbols-outlined input-icon">person</span>
                <input type="text" id="recipeSource" class="glass-input has-icon" placeholder="驻 转?">
              </div>
            </div>

            <!--   -->
            <div class="form-field">
              <label class="form-label" for="preparationTime">  (拽转)</label>
              <div class="form-input-with-icon">
                <span class="material-symbols-outlined input-icon">schedule</span>
                <input type="number" id="preparationTime" class="glass-input has-icon" placeholder="30" min="0">
              </div>
            </div>

            <!-- 拽专 -->
            <div class="form-field">
              <label class="form-label" for="category">拽专</label>
              <div class="category-input-container">
                <div class="form-select-wrapper">
                  <select id="category" class="glass-input form-select" required>
                    <option value="" disabled selected>专转 拽专</option>
                  </select>
                  <span class="material-symbols-outlined select-arrow">expand_more</span>
                </div>
                <input type="text" id="newCategory" class="glass-input" placeholder=" 住祝 拽专 砖" style="display: none;">
                <button type="button" id="toggleNewCategory" class="toggle-category-btn" onclick="toggleCategoryInput()">+ 砖</button>
              </div>
            </div>
          </div>
        </div>
      </form>

      <!-- 驻转专 注专 AI -->
      <div class="form-ai-assistant">
        <button type="button" class="ai-assistant-btn" onclick="openAiChat()">
          <span class="material-symbols-outlined">smart_toy</span>
          <span class="ai-pulse"></span>
        </button>
        <div class="ai-assistant-tooltip">! 爪专 注专 住 转?</div>
      </div>
    </div>
  </div>

  <!-- 转专转  -->
  <div class="backup-reminder" id="backupReminder" style="display: none;">
    <span> !  转 转 转 砖   专.</span>
    <button onclick="closeBackupReminder()"></button>
  </div>

  <!-- 驻 爪' AI - 注爪 砖   -->
  <div class="ai-chat-overlay" id="aiChatOverlay" style="display: none;">
    <div class="ai-chat-container">
      <div class="ai-chat-panel">
        <!-- Header -->
        <div class="ai-chat-header">
          <div class="ai-chat-header-top">
            <div class="ai-chat-header-info">
              <div class="ai-chat-header-avatar">
                <span class="material-symbols-outlined">robot_2</span>
              </div>
              <div class="ai-chat-header-text">
                <h3>AI 注专 砖</h3>
                <div class="ai-chat-header-status">
                  <span class="status-dot"></span>
                  <span>专  注专</span>
                </div>
              </div>
            </div>
            <button class="close-btn" onclick="closeAiChat()" title="住专">
              <span class="material-symbols-outlined">close</span>
            </button>
          </div>
          <!-- History Dropdown -->
          <div class="ai-chat-history-select-wrapper">
            <label>住专转 砖转</label>
            <div class="ai-chat-history-select">
              <select id="aiChatHistorySelect" onchange="loadSelectedConversation(this.value)">
                <option value="new">砖 砖 -  砖 ?</option>
              </select>
              <span class="material-symbols-outlined select-arrow">expand_more</span>
            </div>
          </div>
        </div>

        <!-- Messages -->
        <div class="ai-chat-messages" id="aiChatMessages"></div>

        <!-- Attachments Preview -->
        <div class="ai-chat-attachments" id="aiChatAttachments" style="display: none;"></div>

        <!-- Input Area -->
        <div class="ai-chat-input-area">
          <div class="ai-chat-input-row">
            <button type="button" id="aiChatAttach" onclick="document.getElementById('aiChatFileInput').click()" title="爪专祝 转">
              <span class="material-symbols-outlined">attach_file</span>
            </button>
            <input type="text" id="aiChatInput" placeholder="拽 ..." onkeydown="if(event.key==='Enter')sendAiMessage()">
            <button type="button" id="aiChatVoice" onclick="toggleVoiceRecording()" title="拽 拽">
              <span class="material-symbols-outlined">mic</span>
            </button>
            <button type="button" id="aiChatSend" onclick="sendAiMessage()" title="砖">
              <span class="material-symbols-outlined">send</span>
            </button>
            <input type="file" id="aiChatFileInput" accept="image/*" multiple style="display: none;" onchange="handleChatFileSelect(event)">
          </div>
          <p class="ai-chat-input-helper">-AI 注砖 爪注 砖 爪专转, 拽 转 转  砖.</p>
        </div>
      </div>
    </div>
  </div>

  <!--  砖专 拽 -->
  <div class="popup-overlay" id="confirmPopup" style="display: none;">
    <div class="confirm-popup-content">
      <h3> 专爪 拽 转 转?</h3>
      <button class="confirm" onclick="deleteRecipe()">拽</button>
      <button class="cancel" onclick="closeConfirmPopup()"></button>
    </div>
  </div>

  <!-- Floating Action Buttons -->
  <div class="floating-actions">
    <button class="floating-action-btn ai-chat" onclick="openAiChat()" title="砖 注 AI">
      <img src="/chef-main.png" alt="砖祝" class="chat-btn-chef-icon">
    </button>
    <button class="floating-action-btn" onclick="openFormPopup()" title="住祝 转">
      <span class="material-symbols-outlined">add</span>
    </button>
  </div>

  <!-- 住驻专 爪转 -OCR -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.1/dist/tesseract.min.js"></script>
</body>
</html>
